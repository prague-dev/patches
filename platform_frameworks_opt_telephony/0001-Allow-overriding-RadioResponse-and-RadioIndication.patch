From c93fd1446b1691e78b873ca62439735087c04c1d Mon Sep 17 00:00:00 2001
From: Paul Keith <javelinanddart@gmail.com>
Date: Mon, 7 May 2018 14:07:17 +0200
Subject: [PATCH] RIL: Allow overriding RadioResponse and RadioIndication

* Create RadioResponse and RadioIndication with helper methods
* Make the constructor for RadioIndication public

Change-Id: I57990fb7a25c6b26f633a0f660c5d355c53bc9bb
---
 src/java/com/android/internal/telephony/RIL.java     | 12 ++++++++++--
 .../android/internal/telephony/RadioIndication.java  |  2 +-
 2 files changed, 11 insertions(+), 3 deletions(-)

diff --git a/src/java/com/android/internal/telephony/RIL.java b/src/java/com/android/internal/telephony/RIL.java
index 83398b62cb..54fbed50b1 100644
--- a/src/java/com/android/internal/telephony/RIL.java
+++ b/src/java/com/android/internal/telephony/RIL.java
@@ -592,8 +592,8 @@ public RIL(Context context, int preferredNetworkType,
                 Context.CONNECTIVITY_SERVICE);
         mIsMobileNetworkSupported = cm.isNetworkSupported(ConnectivityManager.TYPE_MOBILE);
 
-        mRadioResponse = new RadioResponse(this);
-        mRadioIndication = new RadioIndication(this);
+        mRadioResponse = createRadioResponse(this);
+        mRadioIndication = createRadioIndication(this);
         mOemHookResponse = new OemHookResponse(this);
         mOemHookIndication = new OemHookIndication(this);
         mRilHandler = new RilHandler();
@@ -633,6 +633,14 @@ private boolean isRadioBugDetectionEnabled() {
                 1) != 0;
     }
 
+    protected RadioResponse createRadioResponse(RIL ril) {
+        return new RadioResponse(ril);
+    }
+
+    protected RadioIndication createRadioIndication(RIL ril) {
+        return new RadioIndication(ril);
+    }
+
     @Override
     public void setOnNITZTime(Handler h, int what, Object obj) {
         super.setOnNITZTime(h, what, obj);
diff --git a/src/java/com/android/internal/telephony/RadioIndication.java b/src/java/com/android/internal/telephony/RadioIndication.java
index 6beab09c21..3fa2985539 100644
--- a/src/java/com/android/internal/telephony/RadioIndication.java
+++ b/src/java/com/android/internal/telephony/RadioIndication.java
@@ -112,7 +112,7 @@
 public class RadioIndication extends IRadioIndication.Stub {
     RIL mRil;
 
-    RadioIndication(RIL ril) {
+    public RadioIndication(RIL ril) {
         mRil = ril;
     }
 
